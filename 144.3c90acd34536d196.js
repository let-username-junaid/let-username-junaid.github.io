"use strict";(self.webpackChunkai_dashboard=self.webpackChunkai_dashboard||[]).push([[144],{1144:(ft,v,s)=>{s.r(v),s.d(v,{DocumentChatModule:()=>gt});var p=s(6814),U=s(1896),t=s(5879),D=s(4104),y=s(4756),f=s(3566),c=s(5313);class _{constructor(a){this.originalError=a}}class C extends _{}const w=(0,s(2306).d)(e=>function(n){e(this),this.name="NotFoundError",this.message=n}),d_serverUrl="https://web-9stmglgx9q6q.up-fi-hel1-1.apps.run-on-seenode.com",m={uploads:d_serverUrl+"/uploads",upload:d_serverUrl+"/upload",deleteById:e=>d_serverUrl+"/upload/"+e,chat:d_serverUrl+"/chat"};var Z=s(7398),u=s(6306),x=s(8504);class N extends _{}var O=s(9862),T=s(2425);let M=(()=>{class e{constructor(n,o){this.httpClient=n,this.toasterService=o}get(n,o){return this.httpClient.get(n,o).pipe((0,u.K)(this.handleError.bind(this)))}post(n,o,i){return this.httpClient.post(n,o,i).pipe((0,u.K)(this.handleError.bind(this)))}put(n,o,i){return this.httpClient.put(n,o,i).pipe((0,u.K)(this.handleError.bind(this)))}delete(n,o){return this.httpClient.delete(n,o).pipe((0,u.K)(this.handleError.bind(this)))}handleError(n){return 400==n.status?(0,x._)(()=>new C(n)):404==n.status?(0,x._)(()=>new N(n)):(this.toasterService.error("Sorry something went wrong."),(0,x._)(()=>new _(n)))}static#t=this.\u0275fac=function(o){return new(o||e)(t.LFG(O.eN),t.LFG(T._W))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),b=(()=>{class e{constructor(n){this.genericHttpService=n}getUploadedDocuments(){return this.genericHttpService.get(m.uploads).pipe((0,Z.U)(n=>n.data))}uploadDocument(n){const o=new FormData;o.set("file",n);const i={headers:(new Headers).set("content-type","multipart/form-data")};return this.genericHttpService.post(m.upload,o,i)}deleteDocument(n){return this.genericHttpService.delete(m.deleteById(n))}getAnswer(n){return this.genericHttpService.post(m.chat,{question:n}).pipe((0,Z.U)(o=>o.data))}static#t=this.\u0275fac=function(o){return new(o||e)(t.LFG(M))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var I=s(2296),h=s(3305),F=s(5940);function E(e,a){1&e&&t._UZ(0,"mat-spinner",9)}function q(e,a){if(1&e&&(t.TgZ(0,"h4"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij("Selected Document : ",n.selecteFileName,"")}}function Y(e,a){if(1&e){const n=t.EpF();t.YNc(0,q,2,1,"h4",10),t.TgZ(1,"button",11),t.NdJ("click",function(){t.CHM(n),t.oxw();const i=t.MAs(6);return t.KtG(i.click())}),t._uU(2,"Select Document"),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("ngIf",n.selecteFileName)}}function Q(e,a){if(1&e&&(t.TgZ(0,"button",12),t._uU(1),t.qZA()),2&e){const n=t.oxw();t.Q6J("disabled",n.isFileUploading),t.xp6(1),t.Oqu(n.isFileUploading?"Uploading...":"Upload")}}function J(e,a){1&e&&t._UZ(0,"mat-spinner",9)}function H(e,a){1&e&&(t.TgZ(0,"th",29),t._uU(1," Name "),t.qZA())}function P(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.originalFileName," ")}}function G(e,a){1&e&&(t.TgZ(0,"th",31),t._uU(1," # Tokens "),t.qZA())}function B(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.numberOfToken," ")}}function L(e,a){1&e&&(t.TgZ(0,"th",32),t._uU(1," Emedding cost (USD) "),t.qZA())}function k(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.totalCost," ")}}function j(e,a){1&e&&(t.TgZ(0,"th",32),t._uU(1," Created On "),t.qZA())}function R(e,a){if(1&e&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,n.createdOn,"MMM dd, yyyy 'at' hh:mm a")," ")}}function z(e,a){1&e&&t._UZ(0,"th",32)}function W(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"td",30)(1,"i",33),t.NdJ("click",function(){const r=t.CHM(n).$implicit,l=t.oxw(3);return t.KtG(l.deleteDocument(r._id))}),t.qZA()()}}function $(e,a){1&e&&t._UZ(0,"tr",34)}function K(e,a){1&e&&t._UZ(0,"tr",35)}const X=function(){return[5,10,20]};function V(e,a){if(1&e&&(t.TgZ(0,"div",15)(1,"table",16),t.ynx(2,17),t.YNc(3,H,2,0,"th",18),t.YNc(4,P,2,1,"td",19),t.BQk(),t.ynx(5,20),t.YNc(6,G,2,0,"th",21),t.YNc(7,B,2,1,"td",19),t.BQk(),t.ynx(8,22),t.YNc(9,L,2,0,"th",23),t.YNc(10,k,2,1,"td",19),t.BQk(),t.ynx(11,24),t.YNc(12,j,2,0,"th",23),t.YNc(13,R,3,4,"td",19),t.BQk(),t.ynx(14,25),t.YNc(15,z,1,0,"th",23),t.YNc(16,W,2,0,"td",19),t.BQk(),t.YNc(17,$,1,0,"tr",26),t.YNc(18,K,1,0,"tr",27),t.qZA(),t._UZ(19,"mat-paginator",28),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("dataSource",n.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(4,X))}}function tt(e,a){1&e&&(t.TgZ(0,"p"),t._uU(1,"No data found."),t.qZA())}function et(e,a){if(1&e&&(t.YNc(0,V,20,5,"div",13),t.YNc(1,tt,2,0,"ng-template",null,14,t.W1O)),2&e){const n=t.MAs(2),o=t.oxw();t.Q6J("ngIf",o.dataSource.data.length)("ngIfElse",n)}}let nt=(()=>{class e{constructor(n,o){this.documentChatService=n,this.toasterService=o,this.selecteFileName="",this.displayedColumns=["originalFileName","numberOfToken","totalCost","createdOn","actions"],this.dataSource=new c.by,this.isLoading=!1,this.isFileUploading=!1}ngOnInit(){this.getUploadedDocuments()}selectDocument(n){this.selecteFileName=n.target.files[0].name,this.uploadDocument(n.target.files[0])}uploadDocument(n){this.isFileUploading=!0,this.documentChatService.uploadDocument(n).subscribe({next:()=>{this.toasterService.success("Document uploaded successfully"),this.getUploadedDocuments(),this.isFileUploading=!1},error:o=>{if(this.isFileUploading=!1,!(o instanceof C))throw o;this.toasterService.error(o.originalError.message)}})}getUploadedDocuments(){this.isLoading=!0,this.documentChatService.getUploadedDocuments().subscribe({next:n=>{this.selecteFileName="",this.dataSource.data=n,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.isLoading=!1},error:n=>{throw this.isLoading=!1,n}})}deleteDocument(n){this.isLoading=!0,this.documentChatService.deleteDocument(n).subscribe({next:()=>{this.dataSource.data=this.dataSource.data.filter(o=>o._id!==n),this.toasterService.success("Document deleted successfully"),this.isLoading=!1},error:o=>{if(this.isLoading=!1,o instanceof C)this.toasterService.error(o.originalError.message);else{if(!(o instanceof w))throw o;this.toasterService.error("Document wit given id does not exists")}}})}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(b),t.Y36(T._W))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-uploaded-documents"]],viewQuery:function(o,i){if(1&o&&(t.Gf(y.NW,5),t.Gf(f.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(i.paginator=r.first),t.iGM(r=t.CRH())&&(i.sort=r.first)}},decls:19,vars:7,consts:[[1,"card"],["type","file","name","file","placeholder","Placeholder","accept","application/pdf",3,"hidden","change"],["input",""],[1,"upload-container"],["class","spinner",4,"ngIf","ngIfElse"],["showUploadForm",""],["mat-raised-button","","color","primary",3,"disabled",4,"ngIf"],[3,"expanded"],["showData",""],[1,"spinner"],[4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","primary",3,"disabled"],["class","table-container",4,"ngIf","ngIfElse"],["noDataFound",""],[1,"table-container"],["mat-table","","matSort","",1,"table-border",3,"dataSource"],["matColumnDef","originalFileName"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by name",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","numberOfToken"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by tokens",4,"matHeaderCellDef"],["matColumnDef","totalCost"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","createdOn"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by name"],["mat-cell",""],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by tokens"],["mat-header-cell",""],["title","delete",1,"fa","fa-trash","fa-lg","icon-delete",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,i){if(1&o&&(t.TgZ(0,"mat-accordion",0)(1,"mat-expansion-panel")(2,"mat-expansion-panel-header")(3,"mat-panel-title"),t._uU(4," Upload Document "),t.qZA()(),t.TgZ(5,"input",1,2),t.NdJ("change",function(l){return i.selectDocument(l)}),t.qZA(),t.TgZ(7,"div",3),t.YNc(8,E,1,0,"mat-spinner",4),t.YNc(9,Y,3,1,"ng-template",null,5,t.W1O),t.qZA(),t.YNc(11,Q,2,2,"button",6),t.qZA(),t.TgZ(12,"mat-expansion-panel",7)(13,"mat-expansion-panel-header")(14,"mat-panel-title"),t._uU(15," Uploaded Documents "),t.qZA()(),t.YNc(16,J,1,0,"mat-spinner",4),t.YNc(17,et,3,2,"ng-template",null,8,t.W1O),t.qZA()()),2&o){const r=t.MAs(10),l=t.MAs(18);t.xp6(5),t.Q6J("hidden",!0),t.xp6(3),t.Q6J("ngIf",i.isFileUploading)("ngIfElse",r),t.xp6(3),t.Q6J("ngIf",i.selecteFileName),t.xp6(1),t.Q6J("expanded",!0),t.xp6(4),t.Q6J("ngIf",i.isLoading)("ngIfElse",l)}},dependencies:[p.O5,I.lW,h.pp,h.ib,h.yz,h.yK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,y.NW,f.YE,f.nU,F.Ou,p.uU],styles:[".card[_ngcontent-%COMP%]{margin:10px}.upload-container[_ngcontent-%COMP%]{padding:10px;display:flex;justify-content:center;align-items:center;border:1px solid #6a6666;flex-direction:column;margin-bottom:10px}.icon-delete[_ngcontent-%COMP%]{color:tomato;cursor:pointer}.table-border[_ngcontent-%COMP%]{border:1px solid #6a6666}.table-container[_ngcontent-%COMP%]{overflow:auto}"]})}return e})();var ot=s(3090),g=s(6223),S=s(5195);const at=["chatInput"];function it(e,a){1&e&&(t.TgZ(0,"div"),t._uU(1,"Generating answer..."),t.qZA())}function st(e,a){if(1&e&&(t.TgZ(0,"div",15)(1,"div",16),t._UZ(2,"i",17),t.qZA(),t.TgZ(3,"div",10)(4,"p"),t._uU(5),t.qZA()()()),2&e){const n=t.oxw(2).$implicit;t.xp6(5),t.Oqu(n.answer)}}function rt(e,a){1&e&&(t.TgZ(0,"p"),t._uU(1,"Error in generating response"),t.qZA())}function ct(e,a){if(1&e&&(t.YNc(0,st,6,1,"div",13),t.YNc(1,rt,2,0,"ng-template",null,14,t.W1O)),2&e){const n=t.MAs(2),o=t.oxw().$implicit;t.Q6J("ngIf",o.answer&&!o.isError)("ngIfElse",n)}}function lt(e,a){if(1&e&&(t.ynx(0),t.TgZ(1,"mat-card",6)(2,"mat-card-content")(3,"div",7)(4,"div",8),t._UZ(5,"i",9),t.qZA(),t.TgZ(6,"div",10)(7,"p"),t._uU(8),t.qZA()()()()(),t.TgZ(9,"mat-card",6)(10,"mat-card-content"),t.YNc(11,it,2,0,"div",11),t.YNc(12,ct,3,2,"ng-template",null,12,t.W1O),t.qZA()(),t.BQk()),2&e){const n=a.$implicit,o=t.MAs(13);t.xp6(8),t.Oqu(n.question),t.xp6(3),t.Q6J("ngIf",n.isGeneratingAnswer)("ngIfElse",o)}}let pt=(()=>{class e{constructor(n,o){this.documentChatService=n,this.appService=o,this.query="",this.isGeneratingAnswer=!1,this.chatHistory=[],this.chatLeftSpace="250px"}ngAfterViewInit(){this.watchSideNav()}generateAnswer(){if(!this.query)return;const n=this.query,o=this.chatHistory.length;this.chatHistory.push({id:o,question:n,answer:"",isGeneratingAnswer:!0,isError:!1}),this.query="",this.isGeneratingAnswer=!0,this.documentChatService.getAnswer(n).subscribe({next:i=>{this.chatHistory[o].answer=i.answer,this.chatHistory[o].isGeneratingAnswer=!1,this.chatHistory[o].isError=!1},error:i=>{throw this.chatHistory[o].isGeneratingAnswer=!1,this.chatHistory[o].isError=!0,i}})}watchSideNav(){this.sideNavSub=this.appService.sideNavBehaviourSubject.subscribe(n=>{this.chatLeftSpace=n?"250px":"0",this.chatInput.nativeElement.focus()})}ngOnDestroy(){this.sideNavSub.unsubscribe()}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(b),t.Y36(ot.z))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-chat"]],viewQuery:function(o,i){if(1&o&&t.Gf(at,5),2&o){let r;t.iGM(r=t.CRH())&&(i.chatInput=r.first)}},decls:6,vars:4,consts:[[1,"chat-container"],[4,"ngFor","ngForOf"],[1,"query-box"],["type","text","placeholder","Enter your query",1,"input",3,"ngModel","ngModelChange"],["chatInput",""],["title","send",1,"fa","fa-share","fa-2x","send-btn",3,"click"],[1,"card"],[1,"request"],[1,"request-icon"],["aria-hidden","true",1,"fa","fa-question-circle","fa-2x"],[1,"response-text"],[4,"ngIf","ngIfElse"],["showAnswer",""],["class","response",4,"ngIf","ngIfElse"],["error",""],[1,"response"],[1,"response-icon"],["aria-hidden","true",1,"fa","fa-info-circle","fa-2x"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0),t.YNc(1,lt,14,3,"ng-container",1),t.TgZ(2,"div",2)(3,"input",3,4),t.NdJ("ngModelChange",function(l){return i.query=l}),t.qZA(),t.TgZ(5,"i",5),t.NdJ("click",function(){return i.generateAnswer()}),t.qZA()()()),2&o&&(t.xp6(1),t.Q6J("ngForOf",i.chatHistory),t.xp6(1),t.Udp("left",i.chatLeftSpace),t.xp6(1),t.Q6J("ngModel",i.query))},dependencies:[p.sg,p.O5,g.Fj,g.JJ,g.On,S.a8,S.dn],styles:[".card[_ngcontent-%COMP%]{margin:10px}.response[_ngcontent-%COMP%], .request[_ngcontent-%COMP%]{display:flex;column-gap:10px}.response-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px}.request-icon[_ngcontent-%COMP%], .response-icon[_ngcontent-%COMP%]{width:30px;flex-shrink:0}.response-icon[_ngcontent-%COMP%]{color:#72cfee}.request-icon[_ngcontent-%COMP%]{color:#f9e650}.chat-container[_ngcontent-%COMP%]{max-height:100%}.query-box[_ngcontent-%COMP%]{position:fixed;bottom:0;display:flex;justify-content:center;align-items:center;right:0;column-gap:10px;background:rgba(255,255,255,.1);padding:10px;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.input[_ngcontent-%COMP%]{padding:15px 20px;outline:none;border:none;width:70%;border-radius:10px}.chat-container[_ngcontent-%COMP%]{margin-bottom:60px}.send-btn[_ngcontent-%COMP%]{cursor:pointer;border:1px solid #fff;padding:6px;border-radius:10px;transition:all 1s ease-in}.send-btn[_ngcontent-%COMP%]:hover{border-color:rgb(var(--color-primary-rgb));color:rgb(var(--color-primary-rgb))}"]})}return e})();function dt(e,a){1&e&&t._UZ(0,"app-chat")}const mt=[{path:"",component:(()=>{class e{constructor(n){this.changeDetectorRef=n,this.showChat=!0}selectedIndexChange(n){this.showChat=!1,0==n&&setTimeout(()=>{this.showChat=!0,this.changeDetectorRef.detectChanges()},900)}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-main-screen"]],decls:5,vars:1,consts:[[3,"selectedIndexChange"],["label","Chat"],[4,"ngIf"],["label","Documents"]],template:function(o,i){1&o&&(t.TgZ(0,"mat-tab-group",0),t.NdJ("selectedIndexChange",function(l){return i.selectedIndexChange(l)}),t.TgZ(1,"mat-tab",1),t.YNc(2,dt,1,0,"app-chat",2),t.qZA(),t.TgZ(3,"mat-tab",3),t._UZ(4,"app-uploaded-documents"),t.qZA()()),2&o&&(t.xp6(2),t.Q6J("ngIf",i.showChat))},dependencies:[p.O5,D.uX,D.SP,nt,pt]})}return e})()}];let ut=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[U.Bz.forChild(mt),U.Bz]})}return e})();var ht=s(6954);let gt=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[p.ez,ut,g.u5,ht.q]})}return e})()}}]);